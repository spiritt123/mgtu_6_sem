\documentclass{bmstu}
\usepackage{xparse}
\usepackage{multirow}

\begin{document}

% Аргументы, помеченные как необязательные, могут быть пустыми. В таком случае соответствующее этому аргументу поле (например, ФИО консультанта) добавлено не будет.

% Титульная страница

% Отчет
\makeatletter %%%%% <---- Starting chapter without a pagebreak
\renewcommand\chapter{\par%
\thispagestyle{plain}% \global\@topnum\z@
\@afterindentfalse \secdef\@chapter\@schapter}
\makeatother

\def\numberWork{1}


\makereporttitle
    {Информатика и системы управления} % Название факультета
    {Компьютерные системы и сети} % Название кафедры
    {09.03.01 Информатика и вычислительная техника} % направение
    {лабораторной работе №~3} % Название работы (в дат. падеже)
    {Арифметическая обработка данных.} % Тема работы
    {Микропроцессорные системы.} % Название курса (необязательный аргумент)
    {5} % Номер варианта (необязательный аргумент)
    {ИУ6-62Б} % Номер группы
    {
    	{ИУ6-62Б}
    	{А.Е.Медведев} % ФИО студента
    	{Б.И.Бычков} % ФИО преподавателя
    } 

\chapter{Цель работы:}
\begin{enumerate}
\item[---] изучение способов представления числовых данных в микроконтроллерах, 
\item[---] изучение двоичных арифметических операций, 
\item[---] программирование арифметических процедур.
\end{enumerate}

\chapter{Задание 1. }

Изучить программу для исследования арифметических операций в стартовом наборе STK500, приведенную ниже.
Программой предусмотрен ввод кода операции, операндов, выполнение заданной операции и показ результатов.
В стартовом наборе STK500 всего восемь кнопок общего назначения (SW7…SW0). При тестировании арифметических операций эти кнопки используются следующим образом: кнопки SW0…SW2 – для ввода младшего (AL) и старшего байта (AH) первого операнда и одного байта второго операнда (BL), SW3…SW6 – для выполнения операций сложения, вычитания, умножения и деления, SW7 – для просмотра.
Ввести в таблицу операндов в конце программы вместо приведенных в тексте программы 10 операндов из таблицы вариантов (Таблица -- \ref{table:var_table}).

\begin{center}
\begin{table}[H]
\caption{Таблица вариантов программируемых операндов в шестнадцатеричном коде}
\label{table:var_table}
\begin{tabular}{| c | c | c | c | c | c | c | c | c | c | c |}
	\hline
	\multirow{2}{4em}{№ вар.}&\multicolumn{2}{|c|}{Беззнаковые}& \multicolumn{8}{|c|}{Числовые операнды со знаком в дополнительном коде} \\
	\cline{2-11}
	& \multicolumn{2}{|c|}{$AL_0~~BL_0$} & \multicolumn{2}{|c|}{$AL_1~~BL_1$} &  \multicolumn{2}{|c|}{$AL_2~~BL_2$}
		& \multicolumn{2}{|c|}{$AL_3~~BL_3$} & \multicolumn{2}{|c|}{$AL_4~~BL_4$} \\
	\hline
	5 &0xD8 & 0xA5 & 0xB3 & 0x6E & 0x4C & 0x3C & 0x9F & 0x7D & 0xB0 & 0xB8 \\
	\hline
\end{tabular}
\end{table}
\end{center}

После загрузки программы в микроконтроллер проверить работу программы на плате, перебирая операнды таблицы с помощью кнопок SW0, SW2 и наблюдая выбираемые операнды в двоичном коде на светодиодной линейке. 

\newpage
\chapter{Выполнение:}
Схема алгоритма работы программы представлена на рисунках \ref{img:alg_scheme_1.png} --- \ref{img:alg_scheme_3.png}.

\includeimage
	{alg_scheme_1.png}
	{f}
	{H}
	{0.3\textwidth} % Ширина рисунка
    {Первая схема алгоритма} 

\includeimage
	{alg_scheme_2.png}
	{f}
	{H}
	{0.4\textwidth} % Ширина рисунка
    {Первая схема алгоритма} 
    
\includeimage
	{alg_scheme_3.png}
	{f}
	{H}
	{0.7\textwidth} % Ширина рисунка
    {Первая схема алгоритма} 

\chapter{Код программы:}

\includelisting
	{demo3.txt}
	{Код программы}

\newpage 
\chapter{Задание 2.}	
 
Выполнить ряд примеров на сложение и вычитание, выбирая операнды слагаемых АL и ВL нажатием кнопок SW0 и SW2.
Объяснить результаты операций при нажатиях кнопки SW3 (сложение) и SW4 (вычитание), рассматривая операнды как 
беззнаковые числа, затем как числа со знаком. В последнем случае загружаемые из таблицы операндов программы 
отрицательные числа, содержащие единицу в старшем разряде, следует рассматривать в дополнительном коде. Нажатие 
кнопки SW7 показывает признаки результата операции, формируемые в регистре SREG (табл.2): C – перенос при сложении 
(заем при вычитании), Z – признак нулевого результата, N – знак результата при операциях с числами со знаком, V – 
переполнение разрядной сетки, $S=N \oplus V$ – знак результата вне зависимости от переполнения, H  – межтетрадный 
перенос (заем). 

\begin{center}
\begin{table}[H]
\caption{Байт признаков результата}
\label{table:flags_table}
\begin{tabular}{| c | c | c | c | c | c | c | c | c |}
	\hline
		№ разряда &7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 \\
	\hline
		Флаг & -- & -- & H & S & V & N & Z & C \\
	\hline
\end{tabular}
\end{table}
\end{center}


Результаты наблюдений (исходные операнды, результаты операций и признаки) привести в табл. 3 в двоичном $(A_2, B_2)$ и десятичном $(А_10,В_10)$ виде. При оценке результатов соблюдать типы обрабатываемых переменных (беззнаковые целые или целые со знаком). \newline


\chapter{Выполнение:}
Для вычислений используем беззнаковые числа и первые четыре знаковых числа от AL1 до BL2. Результаты выполнения операций сложения и вычитания, а также значения признаков в регистре SREG приведены в таблице \ref{table:sub_table}.

\begin{table}[H]
\caption{Результаты операций сложения и вычетания}
\label{table:sub_table}
\begin{tabular}{| c | c | c | c |}
	\hline
		Число $ А_2 / A_{10}$ & Число $ B_2/B_{10}$ & А + В / А - В & \text{Признаки: H S V N Z C} \\	
	\hline
		1101.1000/+216 & 1010.0101/+165 & 0111.1101 (+125) / & 0 1  1 0  0 1 \\
		Беззнаковое & Беззнаковое & 0011.0011 (+51) & 0 0  0 0  0 0 \\
	\hline
		1011.0011/-77 & 0110.1110/+110 & 0010.0001 (+33) / & 1 0  0 0  0 1 \\
		Со знаком & Со знаком & 0100.0101 (+37) & 1 1  1 0  0 0 \\
	\hline
		0100.1100/+76 & 0011.1100/+60 & 1000.1000 (-120) /  & 1 0  1 1  0 0 \\
		Со знаком & Со знаком & 0100.0101 (+16) & 0 0  0 0  0 0 \\
	\hline
		1001.1111/-98 & 0111.1101/+125 & 0001.1100 (+28) / &  1 0 0 0 0 1\\
		Со знаком & Со знаком & 0010.0010 (+34) & 0 1  1 0  0 0 \\
	\hline
		1011.0000/-88 & 1011.1000/-72 & 0110.1000 (+104) / & 0 1  1 0  0 1 \\
		Со знаком & Со знаком & 1111.1000 (-8) & 1 1  0 1  0 1 \\
	\hline
\end{tabular}
\end{table}

\chapter{Умножение и деление целых чисел}
\textbf{Задание 3.} \\
Выполнить ряд примеров умножения 8-разрядных двоичных чисел с разными операциями умножения, выбирая 
соответствующие им операнды из таблицы операндов и проверяя результаты с помощью калькулятора. Нажатие кнопки SW5 
показывает младший байт произведения, SW7 – старший байт.
\\
\textbf{Выполнение:}
На рисунке \ref{img:lab3_mul_scheme.png} изображена схема алгоритма операции умножения.

\includeimage
	{lab3_mul_scheme.png}
	{f}
	{H}
	{0.3\textwidth}
	{Схема умножение двоичных чисел}

Для демонстрации примера выполнения умножения используем числа $AL_1$ до $BL_1$, не учитывая знаки.

\begin{table}[h]
\caption{Входные данные для умножения}
	\label{table:mul_table_ex}
	\begin{tabular}{|c|c|}
	\hline
		Число A2/A10 & Число B2/B10 \\
	\hline
		1011.0011 = 179 & 0110.1110 = 110 \\
	\hline
	\end{tabular}
\end{table}


\begin{table}[h]
\caption{Произведение двух чисел равно:}
	\label{table:mul_table}
	\begin{tabular}{|ccccccccccccccc|}
	\hline
		&&&&&&*&1&0&1&1&0&0&1&1\\
		&&&&&&&0&1&1&0&1&1&1&0\\
	\cline{8-15}
		&&&&&&&0&0&0&0&0&0&0&0\\
		&&&&&&1&0&1&1&0&0&1&1&\\
		&&&&&1&0&1&1&0&0&1&1&&\\
		&&&&1&0&1&1&0&0&1&1&&&\\
		&&&0&0&0&0&0&0&0&0&&&&\\
		&&1&0&1&1&0&0&1&1&&&&&\\
		&1&0&1&1&0&0&1&1&&&&&&\\
		0&0&0&0&0&0&0&0&&&&&&&\\
	\hline
		1&0&0&1&1&0&0&1&1&1&0&1&0&1&0\\
	\hline
	\end{tabular}
\end{table}

Результат: 0100110011101010 = 19690. Проверка = 179 * 110 = 19690 \newline
В таблице \ref{table:mul_answer} приведены результаты выполнения операций умножения.

\begin{table}[h]
\caption{Результаты операции умножения}
	\label{table:mul_table}
	\begin{tabular}{|ccccccccccccccc|}
	\hline
	\hline
	\end{tabular}
\end{table}

При перемножении знаковых чисел в код были внесены изменения, а именно:
\begin{enumerate}
\item При перемножении двух знаковых чисел операция mul была заменена на muls
\item При перемножении знакового и беззнакового числа операция mul была заменена на mulsu.
\end{enumerate}

\newpage
\chapter{Задание 4.}
Выполнить деление беззнаковых чисел, 16-разрядного делимого на 8-разрядный делитель, с восстановлением остатка при 
условиях, что делитель не равен 0 и его значение не вызовет переполнения, а также делимое и делитель заданы с 
нулевыми значениями старших разрядов. Если деление невозможно, выводится предупреждение путем зажигания и гашения 
всех светодиодов. Нажатие кнопки SW6 показывает частное, SW7 – остаток. \\ 
Выполнить 2-3 примера на деление двоичных чисел, самостоятельно подобрав делимое и делитель. Подобрать пример с 
максимальными значениями делимого AH.AL и делителя B, при которых частное С будет равно 0b11111111, изменив в 
случае необходимости программную таблицу операндов. \\
Запротоколировать деление двух операндов по шагам по образцу примера из описания алгоритма, указывая промежуточные 
значения в регистрах делимого (остатка) AH.AL и частного С.

\textbf{Выполнение:} \\
На рисунке \ref{img:lab3_div.png} изображена схема алгоритма операции деления.
В таблице \ref{table:div_table} приведены результаты выполнения операций деления.

\begin{table}[h]
\caption{Результаты операции умножения}
	\label{table:div_table}
	\begin{tabular}{|c|c|c|c|}
	\hline
		$AH_2 AL_2 / A_{10}$ & $BL_2 / B_{10}$ & Частное & Остаток\\
	\hline
	 	0000.0100 0110.1110/1134 & 0100.1100/76 & 14 & 70

	\end{tabular}
\end{table}

\includeimage
	{lab3_div.png}
	{f}
	{H}
	{0.5\textwidth}
	{Схема алгоритма деления}
	
Далее пошагово расписано деление чисел из первой строчки таблицы \ref{table:div_table}:

\begin{table}[H]
\caption{Результаты операции умножения}
	\label{table:mul_table}
	\begin{tabular}{|cccccccc|cccccccc|c|}
	\hline
		0&0&0&0&0&1&0&0&0&1&1&0&1&1&1&0&\\
		1&0&1&1&0&1&0&0&&&&&&&&&\\
	\cline{1-16}
		1&0&1&1&1&0&0&0&&&&&&&&& >0 Переполнения нет!\\
	\hline
	\hline
		0&0&0&0&1&0&0&0&1&1&0&1&1&1&0&x&\multirow{3}{10em}{<0 => $c_7 = 0$ \\ Востановление!}\\
		1&0&1&1&0&1&0&0&&&&&&&&&\\
	\cline{1-16}
		1&0&1&1&1&1&0&0&&&&&&&&&\\
	\hline
	\hline
		0&0&0&1&0&0&0&1&1&0&1&1&1&0&x&x&\multirow{3}{10em}{<0 => $c_6 = 0$ \\ Востановление!}\\
		1&0&1&1&0&1&0&0&&&&&&&&&\\
	\cline{1-16}
		1&1&0&0&0&1&0&1&&&&&&&&&\\
	\hline
	\hline
		0&0&1&0&0&0&1&1&0&1&1&1&0&x&x&x&\multirow{3}{10em}{<0 => $c_5 = 0$ \\ Востановление!}\\
		1&0&1&1&0&1&0&0&&&&&&&&&\\
	\cline{1-16}
		1&1&0&1&0&1&1&1&&&&&&&&&\\
	\hline
	\hline
		0&1&0&0&0&1&1&0&1&1&1&0&x&x&x&x&\multirow{3}{10em}{<0 => $c_4 = 0$ \\ Востановление!}\\
		1&0&1&1&0&1&0&0&&&&&&&&&\\
	\cline{1-16}
		1&1&1&1&1&0&1&0&&&&&&&&&\\
	\hline
	\hline
		1&0&0&0&1&1&0&1&1&1&0&x&x&x&x&x&\multirow{3}{10em}{>0 => $c_3 = 1$ \\ Сдвиг!}\\
		1&0&1&1&0&1&0&0&&&&&&&&&\\
	\cline{1-16}
		0&1&0&0&0&0&0&1&&&&&&&&&\\
	\hline
	\hline
		1&0&0&0&0&0&1&1&1&0&x&x&x&x&x&x&\multirow{3}{10em}{>0 => $c_2 = 1$ \\ Сдвиг!}\\
		1&0&1&1&0&1&0&0&&&&&&&&&\\
	\cline{1-16}
		0&0&1&1&0&1&1&1&&&&&&&&&\\
	\hline
	\hline
		0&1&1&0&1&1&1&1&0&x&x&x&x&x&x&x&\multirow{3}{10em}{>0 => $c_1 = 1$ \\ Сдвиг!}\\
		1&0&1&1&0&1&0&0&&&&&&&&&\\
	\cline{1-16}
		0&0&1&0&0&0&1&1&&&&&&&&&\\
	\hline
	\hline
		0&1&0&0&0&1&1&0&x&x&x&x&x&x&x&x&\multirow{3}{10em}{<0 => $c_0 = 0$}\\
		1&0&1&1&0&1&0&0&&&&&&&&&\\
	\cline{1-16}
		1&1&1&1&1&0&1&0&&&&&&&&&\\
	\hline
	\hline
		1&1&1&1&1&0&1&0&&&&&&&&&\multirow{3}{10em}{Остаток}\\
		0&1&0&0&1&1&0&0&&&&&&&&&\\
	\cline{1-16}
		0&1&0&0&0&1&1&0&&&&&&&&&\\
	\hline
	\end{tabular}
\end{table}

После деления А на В получам число С = 00001110 в двоичной системе. Переведя его в десятичную получим, что при делениии 1134 на 76 получаем 14 целых и 70 в остатке.

В третьей строке таблицы \ref{table:div_table} подобран пример с максимальными значениями делимого AH.AL и 
делителя B, при которых частное С будет равно 11111111 = 255. В соответствии с условием задачи, делитель не может 
начинаться с 0, тогда наибольшим делителем будет число 01111111 = 127, а его остатком – 01111110 = 126. Тогда 
наибольшим значением делимого будет число 127 * 255 + 126 = 32511 = 0111111011111111, что удовлетворяет условию 
задания. \\

\chapter{Вывод}

В ходе данной лабораторной работы были изучены способы представления целых чисел, дробных чисел, чисел со знаком и 
без знака в микроконтроллерах: целые числа имеют формат с фиксированной точкой справа, дробные числа меньше 
единицы имеют формат с точкой слева. При целочисленном представлении старший разряд используется для представления 
знака: 0 – положительный, а 1 – отрицательный. Изучены предназначения битов регистра SREG: C – перенос при 
сложении, Z –признак нулевого результата, N – знак результата при операциях с числами со знаком, V – переполнение 
разрядной сетки, $S=N \oplus V$ – знак результата вне зависимости от переполнения, H – межтетрадный перенос. Также 
были изучены двоичные арифметические операции и описаны программы арифметических процедур.


\end{document}

\begin{comment}
\includeimage
    {tux} % Имя файла без расширения (файл должен быть расположен в директории inc/img/)
    {f} % Обтекание (без обтекания)
    {h} % Положение рисунка (см. figure из пакета float)
    {0.25\textwidth} % Ширина рисунка
    {Символ Linux (Tux)} % Подпись рисунка

На~листингах представлен исходный код программы Hello World на~языке программирования C в~двух вариантах оформления.

\includelisting {main.c} % Имя файла с расширением (файл должен быть расположен в директории inc/lst/) {Исходный код программы Hello World} % Подпись листинга

\includelistingpretty
    {main.c} % Имя файла с расширением (файл должен быть расположен в директории inc/lst/)
    {c} % Язык программирования (необязательный аргумент)
    {Исходный код программы Hello World} % Подпись листинга



\end{comment}
